(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[0],{114:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(23),s=n.n(c),i=n(8),o=n(52),u=(n(84),n(85),n(9)),l=n(53),j=n.n(l),b=n(1);function d(e){var t=e.title,n=e.children;return Object(b.jsxs)("div",{className:j.a.section,children:[Object(b.jsx)("h1",{className:j.a.title,children:t}),n]})}var O=n(116);function f(e){var t=e.message;return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h2",{children:t}),Object(b.jsx)(O.a,{animation:"grow",variant:"primary"})]})}var h=n(10),p=n(121),m=n(117),g=n(16),x=n.n(g),v=n(25),L=n(11),_=n(20),k=n.n(_);k.a.defaults.baseURL="https://connections-api.herokuapp.com";var y=function(e){k.a.defaults.headers.common.Authorization="Bearer ".concat(e)},w=function(){k.a.defaults.headers.common.Authorization=""},C=Object(L.c)("auth/register",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("/users/signup",t);case 3:return r=e.sent,a=r.data,y(a.token),e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",n.rejectWithValue(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()),N=Object(L.c)("auth/login",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("/users/login",t);case 3:return r=e.sent,a=r.data,y(a.token),e.abrupt("return",a);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",n.rejectWithValue(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()),I=Object(L.c)("auth/logout",function(){var e=Object(v.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k.a.post("/users/logout");case 3:w(),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",n.rejectWithValue(e.t0.message));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()),S=Object(L.c)("auth/refresh",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,c,s;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState(),null!==(a=r.auth.token)){e.next=4;break}return e.abrupt("return",n.rejectWithValue());case 4:return y(a),e.prev=5,e.next=8,k.a.get("/users/current");case 8:return c=e.sent,s=c.data,e.abrupt("return",s);case 13:return e.prev=13,e.t0=e.catch(5),e.abrupt("return",n.rejectWithValue(e.t0.message));case 16:case"end":return e.stop()}}),e,null,[[5,13]])})));return function(t,n){return e.apply(this,arguments)}}());function B(){var e=Object(i.b)(),t=Object(r.useState)(""),n=Object(h.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),o=Object(h.a)(s,2),u=o[0],l=o[1],j=Object(r.useState)(""),d=Object(h.a)(j,2),O=d[0],f=d[1],g=function(e){var t=e.currentTarget,n=t.name,r=t.value;switch(n){case"name":return c(r);case"email":return l(r);case"password":return f(r);default:return}};return Object(b.jsx)("div",{children:Object(b.jsxs)(p.a,{onSubmit:function(t){t.preventDefault(),e(C({name:a,email:u,password:O})),c(""),l(""),f("")},children:[Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"floatingTextarea",children:[Object(b.jsx)(p.a.Label,{children:"Name"}),Object(b.jsx)(p.a.Control,{type:"text",placeholder:"Enter name",name:"name",required:!0,value:a,onChange:g})]}),Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(b.jsx)(p.a.Label,{children:"Email"}),Object(b.jsx)(p.a.Control,{type:"email",placeholder:"Enter email",name:"email",required:!0,value:u,onChange:g})]}),Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(b.jsx)(p.a.Label,{children:"Password"}),Object(b.jsx)(p.a.Control,{type:"password",placeholder:"Enter password",name:"password",required:!0,value:O,onChange:g})]}),Object(b.jsx)(m.a,{variant:"outline-primary",type:"submit",children:"Registration"})]})})}function F(){var e=Object(i.b)(),t=Object(r.useState)(""),n=Object(h.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(""),o=Object(h.a)(s,2),u=o[0],l=o[1],j=function(e){var t=e.currentTarget,n=t.name,r=t.value;switch(n){case"email":return c(r);case"password":return l(r);default:return}};return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(p.a,{onSubmit:function(t){t.preventDefault(),e(N({email:a,password:u})),c(""),l("")},children:[Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"formBasicEmail",children:[Object(b.jsx)(p.a.Label,{children:"Email"}),Object(b.jsx)(p.a.Control,{type:"email",placeholder:"Enter email",name:"email",required:!0,value:a,onChange:j})]}),Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"formBasicPassword",children:[Object(b.jsx)(p.a.Label,{children:"Password"}),Object(b.jsx)(p.a.Control,{type:"password",placeholder:"Enter password",name:"password",required:!0,value:u,onChange:j})]}),Object(b.jsx)(m.a,{variant:"outline-primary",type:"submit",children:"Log In"})]})})}var E=n(45),T=n.n(E);function G(e){var t=e.userMail,n=Object(i.b)();return Object(b.jsxs)("div",{className:T.a.navGreetings,children:[Object(b.jsxs)("p",{className:T.a.greetings,children:["Hello, ",t]}),Object(b.jsx)(m.a,{variant:"outline-light",onClick:function(e){n(I())},className:T.a.button,children:"Log out"})]})}var M=function(e){return e.auth.user.name},U=function(e){return e.auth.isLoggedIn},A=function(e){return e.auth.isGetCurrentUser},P=function(e){return e.auth.error},V=function(e){return e.auth.isLoading},W=n(119),z=n(118),q=n(120),R=n(29),D=n.n(R);function X(){var e=Object(i.c)(U),t=Object(i.c)(M);return Object(b.jsx)(b.Fragment,{children:Object(b.jsx)(W.a,{bg:"primary",variant:"dark",sticky:"top",className:D.a.navigation,children:Object(b.jsxs)(z.a,{children:[Object(b.jsx)(W.a.Brand,{exact:"true",to:"/",children:"Phonebook"}),Object(b.jsx)(q.a,{className:"me-auto",children:Object(b.jsxs)("div",{className:D.a.navigationBar,children:[Object(b.jsx)(q.a.Link,{exact:"true",href:"/",className:D.a.home,children:"Home"}),e?Object(b.jsxs)("div",{className:D.a.greetingsBox,children:[Object(b.jsx)(q.a.Link,{href:"/contacts",className:D.a.phonebook,children:"Phonebook"}),Object(b.jsx)(G,{userMail:t,className:D.a.userMenu})]}):Object(b.jsxs)("div",{className:D.a.entrance,children:[Object(b.jsx)(q.a.Link,{exact:"true",href:"/login",children:"LogIn"}),Object(b.jsx)(q.a.Link,{href:"/register",children:"Registration"})]})]})})]})})})}var Z=n(2),J=n(3),H=["children","redirectTo"];function K(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/":n,a=Object(J.a)(e,H),c=Object(i.c)(U);return Object(b.jsx)(u.b,Object(Z.a)(Object(Z.a)({},a),{},{children:c?t:Object(b.jsx)(u.a,{to:r})}))}var Y=["children","restricted","redirectTo"];function Q(e){var t=e.children,n=e.restricted,r=void 0!==n&&n,a=e.redirectTo,c=void 0===a?"/":a,s=Object(J.a)(e,Y),o=Object(i.c)(U)&&r;return Object(b.jsx)(u.b,Object(Z.a)(Object(Z.a)({},s),{},{children:o?Object(b.jsx)(u.a,{to:c}):t}))}var $=n(71),ee=n.n($),te=n(39),ne=function(e){return e.contacts.contacts},re=function(e){return e.contacts.filteredContacts},ae=function(e){return e.contacts.error},ce=function(e){return e.contacts.isLoading},se=Object(te.a)([ne,re],(function(e,t){var n=t.toLowerCase();return e.filter((function(e){return e.name.toLowerCase().includes(n)}))})),ie=Object(L.c)("contacts/fetchContacts",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState(),a=r.auth.token,y(a),e.prev=3,e.next=6,k.a.get("/contacts");case 6:return c=e.sent,e.abrupt("return",c.data);case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",n.rejectWithValue(e.t0.message));case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t,n){return e.apply(this,arguments)}}()),oe=Object(L.c)("contacts/addContacts",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a,c,s,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,a=t.number,c=n.getState(),s=c.auth.token,y(s),e.prev=4,e.next=7,k.a.post("/contacts",{name:r,number:a});case 7:return i=e.sent,e.abrupt("return",i.data);case 11:return e.prev=11,e.t0=e.catch(4),e.abrupt("return",n.rejectWithValue(e.t0.message));case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t,n){return e.apply(this,arguments)}}()),ue=Object(L.c)("contacts/deleteContacts",function(){var e=Object(v.a)(x.a.mark((function e(t,n){var r,a;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.getState(),a=r.auth.token,y(a),e.prev=3,e.next=6,k.a.delete("/contacts/".concat(t));case 6:return e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",n.rejectWithValue(e.t0.message));case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t,n){return e.apply(this,arguments)}}());function le(){var e=Object(r.useState)(""),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),s=Object(h.a)(c,2),o=s[0],u=s[1],l=Object(i.b)(),j=Object(i.c)(ne),d=function(e){var t=e.currentTarget,n=t.name,r=t.value;switch(n){case"name":return a(r);case"number":return u(r);default:return}};return Object(b.jsxs)(p.a,{onSubmit:function(e){e.preventDefault(),a(""),u(""),j.find((function(e){return e.name.toLowerCase()===n.toLowerCase()}))?alert("".concat(n," is already in contacts")):l(oe({name:n,number:o}))},className:ee.a.form,children:[Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"floatingTextarea",children:[Object(b.jsx)(p.a.Label,{children:"Name"}),Object(b.jsx)(p.a.Control,{type:"text",placeholder:"Enter name",name:"name",pattern:"^[a-zA-Z\u0430-\u044f\u0410-\u042f]+(([' -][a-zA-Z\u0430-\u044f\u0410-\u042f ])?[a-zA-Z\u0430-\u044f\u0410-\u042f]*)*$",title:"\u0418\u043c\u044f \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0438\u0437 \u0431\u0443\u043a\u0432, \u0430\u043f\u043e\u0441\u0442\u0440\u043e\u0444\u0430, \u0442\u0438\u0440\u0435 \u0438 \u043f\u0440\u043e\u0431\u0435\u043b\u043e\u0432. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 Adrian, Jacob Mercer, Charles de Batz de Castelmore d'Artagnan \u0438 \u0442. \u043f.",required:!0,value:n,onChange:d})]}),Object(b.jsxs)(p.a.Group,{className:"mb-3",controlId:"floatingTextarea",children:[Object(b.jsx)(p.a.Label,{children:"Number"}),Object(b.jsx)(p.a.Control,{placeholder:"Enter number",type:"tel",name:"number",pattern:"\\+?\\d{1,4}?[-.\\s]?\\(?\\d{1,3}?\\)?[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,4}[-.\\s]?\\d{1,9}",title:"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0446\u0438\u0444\u0440 \u0438 \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0442\u0438\u0440\u0435, \u043a\u0440\u0443\u0433\u043b\u044b\u0435 \u0441\u043a\u043e\u0431\u043a\u0438 \u0438 \u043c\u043e\u0436\u0435\u0442 \u043d\u0430\u0447\u0438\u043d\u0430\u0442\u044c\u0441\u044f \u0441 +",required:!0,value:o,onChange:d})]}),Object(b.jsx)(m.a,{variant:"outline-primary",type:"submit",children:"Add contact"})]})}var je=n(122),be=n(66);function de(e){var t=e.filter,n=e.onFindName;return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(je.a,{className:"mb-3",children:[Object(b.jsx)(je.a.Text,{id:"basic-addon1",children:"Find contact by name"}),Object(b.jsx)(be.a,{placeholder:"Username","aria-label":"Username","aria-describedby":"basic-addon1",type:"text",name:"filter",value:t,onChange:n})]})})}var Oe=n(123),fe=n(46),he=n.n(fe);function pe(e){var t=e.contacts,n=e.onBtnClick;return Object(b.jsx)(Oe.a,{variant:"flush",className:he.a.contactList,children:t.map((function(e){var t=e.id,r=e.name,a=e.number;return Object(b.jsxs)(Oe.a.Item,{variant:"warning",className:he.a.contactItem,children:[Object(b.jsxs)("span",{className:he.a.contactInfo,children:[r,": ",a]}),Object(b.jsx)(m.a,{variant:"outline-danger",onClick:function(){return n(t)},children:"Delete"})]},t)}))})}var me=Object(L.b)("contactList/filter",(function(e){return{payload:e}})),ge=n(72),xe=n.n(ge);function ve(){var e=Object(i.c)(se),t=Object(i.c)(re),n=Object(i.c)(ae),a=Object(i.c)(ce),c=Object(i.c)(ne),s=Object(i.b)();Object(r.useEffect)((function(){s(ie())}),[s]);return Object(b.jsx)(b.Fragment,{children:Object(b.jsxs)(d,{title:"Phonebook",children:[Object(b.jsx)(le,{}),Object(b.jsx)("h2",{className:xe.a.title,children:"Contacts"}),c.length>1&&Object(b.jsx)(de,{value:t,onFindName:function(e){s(me(e.target.value))}}),n&&Object(b.jsx)(f,{message:n}),a&&Object(b.jsx)(f,{message:"Loading..."}),0!==e.length&&Object(b.jsx)(pe,{contacts:e,onBtnClick:function(e){return s(ue(e))}})]})})}function Le(){var e=Object(i.b)(),t=Object(i.c)(A),n=Object(i.c)(P),a=Object(i.c)(V);return Object(r.useEffect)((function(){e(S())}),[e]),Object(b.jsx)(b.Fragment,{children:t?Object(b.jsx)(d,{title:"Phonebook"}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(X,{}),Object(b.jsxs)(u.d,{children:[Object(b.jsx)(Q,{exact:!0,path:"/",children:Object(b.jsx)(d,{title:"Welcome to your wonderful phonebook"})}),Object(b.jsx)(Q,{exact:!0,path:"/register",restricted:!0,children:Object(b.jsxs)(d,{title:"Registration",children:[Object(b.jsx)(B,{}),a&&Object(b.jsx)(f,{message:"Loading"}),n&&Object(b.jsx)(f,{message:n})]})}),Object(b.jsx)(Q,{path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(b.jsxs)(d,{title:"Login",children:[Object(b.jsx)(F,{}),a&&Object(b.jsx)(f,{message:"Loading"}),n&&Object(b.jsx)(f,{message:n})]})}),Object(b.jsx)(K,{path:"/contacts",redirectTo:"/login",children:a?Object(b.jsx)(f,{message:"Loading"}):Object(b.jsx)(ve,{})})]})]})})}var _e,ke,ye,we,Ce=n(44),Ne=n(4),Ie=n(15),Se=Object(L.d)([],(_e={},Object(Ne.a)(_e,ie.fulfilled,(function(e,t){return t.payload})),Object(Ne.a)(_e,oe.fulfilled,(function(e,t){return[].concat(Object(Ce.a)(e),[t.payload])})),Object(Ne.a)(_e,ue.fulfilled,(function(e,t){return e.filter((function(e){return e.id!==t.payload}))})),_e)),Be=Object(L.d)("",Object(Ne.a)({},me,(function(e,t){return t.payload}))),Fe=Object(L.d)(null,(ke={},Object(Ne.a)(ke,ie.rejected,(function(e,t){return t.payload})),Object(Ne.a)(ke,oe.rejected,(function(e,t){return t.payload})),Object(Ne.a)(ke,ue.rejected,(function(e,t){return t.payload})),Object(Ne.a)(ke,ie.pending,(function(){return null})),Object(Ne.a)(ke,oe.pending,(function(){return null})),Object(Ne.a)(ke,ue.pending,(function(){return null})),ke)),Ee=Object(L.d)(!1,(ye={},Object(Ne.a)(ye,ie.pending,(function(){return!0})),Object(Ne.a)(ye,oe.pending,(function(){return!0})),Object(Ne.a)(ye,ue.pending,(function(){return!0})),Object(Ne.a)(ye,ie.fulfilled,(function(){return!1})),Object(Ne.a)(ye,oe.fulfilled,(function(){return!1})),Object(Ne.a)(ye,ue.fulfilled,(function(){return!1})),Object(Ne.a)(ye,ie.rejected,(function(){return!1})),Object(Ne.a)(ye,oe.rejected,(function(){return!1})),Object(Ne.a)(ye,ue.rejected,(function(){return!1})),ye)),Te=Object(Ie.b)({contacts:Se,filteredContacts:Be,error:Fe,isLoading:Ee}),Ge=Object(L.e)({name:"auth",initialState:{user:{name:null,email:null,password:null},token:null,isLoggedIn:!1,isGetCurrentUser:!1,error:null,isLoading:!1},extraReducers:(we={},Object(Ne.a)(we,C.pending,(function(e,t){e.error=null,e.isLoading=!0})),Object(Ne.a)(we,C.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0,e.isLoading=!1})),Object(Ne.a)(we,C.rejected,(function(e,t){e.error=t.payload,e.isLoading=!1})),Object(Ne.a)(we,N.pending,(function(e,t){e.isLoading=!0,e.error=null})),Object(Ne.a)(we,N.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0,e.isLoading=!1})),Object(Ne.a)(we,N.rejected,(function(e,t){e.error=t.payload,e.isLoading=!1})),Object(Ne.a)(we,I.pending,(function(e,t){e.isLoading=!0,e.error=null})),Object(Ne.a)(we,I.fulfilled,(function(e,t){e.user={name:null,email:null,password:null},e.token=null,e.isLoggedIn=!1,e.isLoading=!1})),Object(Ne.a)(we,I.rejected,(function(e,t){e.error=t.payload,e.isLoading=!1})),Object(Ne.a)(we,S.pending,(function(e,t){e.isFetchingCurrentUser=!0,e.isLoading=!0,e.error=null})),Object(Ne.a)(we,S.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isFetchingCurrentUser=!1,e.isLoading=!1})),Object(Ne.a)(we,S.rejected,(function(e,t){e.isFetchingCurrentUser=!1,e.isLoading=!1})),we)}).reducer,Me=n(26),Ue=n(73),Ae=n.n(Ue),Pe=Object(Ce.a)(Object(L.f)({serializableCheck:{ignoredActions:[Me.a,Me.f,Me.b,Me.c,Me.d,Me.e]}})),Ve={key:"auth",storage:Ae.a,whitelist:["token"]},We=Object(L.a)({reducer:{auth:Object(Me.g)(Ve,Ge),contacts:Te},middleware:Pe,devTools:!1}),ze=Object(Me.h)(We),qe=n(74);s.a.render(Object(b.jsx)(a.a.StrictMode,{children:Object(b.jsx)(i.a,{store:We,children:Object(b.jsx)(qe.a,{loading:null,persistor:ze,children:Object(b.jsx)(o.a,{children:Object(b.jsx)(Le,{})})})})}),document.getElementById("root"))},29:function(e,t,n){e.exports={navigationBar:"Navigation_navigationBar__1vVpB",greetingsBox:"Navigation_greetingsBox__3QcOM",phonebook:"Navigation_phonebook__2lugM",entrance:"Navigation_entrance__1uXEp"}},45:function(e,t,n){e.exports={navGreetings:"UserMenu_navGreetings__1Yudv",greetings:"UserMenu_greetings__1stBN",button:"UserMenu_button__2SpX6"}},46:function(e,t,n){e.exports={contactItem:"ContactList_contactItem__32Eyn",contactInfo:"ContactList_contactInfo__1ssMI",button:"ContactList_button__dTj4r"}},53:function(e,t,n){e.exports={section:"Section_section__dzfg5",title:"Section_title__KKipS"}},71:function(e,t,n){e.exports={form:"ContactForm_form__mZYtA",label:"ContactForm_label__1GXtS",input:"ContactForm_input__2pTkx",button:"ContactForm_button__2dVLX"}},72:function(e,t,n){e.exports={title:"ContactsPage_title__3P2IW"}},85:function(e,t,n){}},[[114,1,2]]]);
//# sourceMappingURL=main.6d556a6f.chunk.js.map